// Grover search on 64 qubits and 64 helper qubits

circuit: 128 qubits

// Init
H(0)
H(1)
H(2)
H(3)
H(4)
H(5)
H(6)
H(7)
H(8)
H(9)
H(10)
H(11)
H(12)
H(13)
H(14)
H(15)
H(16)
H(17)
H(18)
H(19)
H(20)
H(21)
H(22)
H(23)
H(24)
H(25)
H(26)
H(27)
H(28)
H(29)
H(30)
H(31)
H(32)
H(33)
H(34)
H(35)
H(36)
H(37)
H(38)
H(39)
H(40)
H(41)
H(42)
H(43)
H(44)
H(45)
H(46)
H(47)
H(48)
H(49)
H(50)
H(51)
H(52)
H(53)
H(54)
H(55)
H(56)
H(57)
H(58)
H(59)
H(60)
H(61)
H(62)
H(63)

// Grover iteration 1
NCNCNOT(0,1,64)
NCCNOT(2,64,65)
NCCNOT(3,65,66)
NCCNOT(4,66,67)
NCCNOT(5,67,68)
NCCNOT(6,68,69)
NCCNOT(7,69,70)
NCCNOT(8,70,71)
NCCNOT(9,71,72)
NCCNOT(10,72,73)
NCCNOT(11,73,74)
NCCNOT(12,74,75)
NCCNOT(13,75,76)
NCCNOT(14,76,77)
NCCNOT(15,77,78)
NCCNOT(16,78,79)
NCCNOT(17,79,80)
NCCNOT(18,80,81)
NCCNOT(19,81,82)
NCCNOT(20,82,83)
NCCNOT(21,83,84)
NCCNOT(22,84,85)
NCCNOT(23,85,86)
NCCNOT(24,86,87)
NCCNOT(25,87,88)
NCCNOT(26,88,89)
NCCNOT(27,89,90)
NCCNOT(28,90,91)
NCCNOT(29,91,92)
NCCNOT(30,92,93)
NCCNOT(31,93,94)
NCCNOT(32,94,95)
NCCNOT(33,95,96)
NCCNOT(34,96,97)
NCCNOT(35,97,98)
NCCNOT(36,98,99)
NCCNOT(37,99,100)
NCCNOT(38,100,101)
NCCNOT(39,101,102)
NCCNOT(40,102,103)
NCCNOT(41,103,104)
NCCNOT(42,104,105)
NCCNOT(43,105,106)
NCCNOT(44,106,107)
NCCNOT(45,107,108)
NCCNOT(46,108,109)
NCCNOT(47,109,110)
NCCNOT(48,110,111)
NCCNOT(49,111,112)
NCCNOT(50,112,113)
NCCNOT(51,113,114)
NCCNOT(52,114,115)
NCCNOT(53,115,116)
NCCNOT(54,116,117)
NCCNOT(55,117,118)
NCCNOT(56,118,119)
NCCNOT(57,119,120)
NCCNOT(58,120,121)
NCCNOT(59,121,122)
NCCNOT(60,122,123)
NCCNOT(61,123,124)
NCCNOT(62,124,125)
NCCNOT(63,125,126)
CNOT(126,127)
// The key step!
Z(127)
CNOT(126,127)
NCCNOT(63,125,126)
NCCNOT(62,124,125)
NCCNOT(61,123,124)
NCCNOT(60,122,123)
NCCNOT(59,121,122)
NCCNOT(58,120,121)
NCCNOT(57,119,120)
NCCNOT(56,118,119)
NCCNOT(55,117,118)
NCCNOT(54,116,117)
NCCNOT(53,115,116)
NCCNOT(52,114,115)
NCCNOT(51,113,114)
NCCNOT(50,112,113)
NCCNOT(49,111,112)
NCCNOT(48,110,111)
NCCNOT(47,109,110)
NCCNOT(46,108,109)
NCCNOT(45,107,108)
NCCNOT(44,106,107)
NCCNOT(43,105,106)
NCCNOT(42,104,105)
NCCNOT(41,103,104)
NCCNOT(40,102,103)
NCCNOT(39,101,102)
NCCNOT(38,100,101)
NCCNOT(37,99,100)
NCCNOT(36,98,99)
NCCNOT(35,97,98)
NCCNOT(34,96,97)
NCCNOT(33,95,96)
NCCNOT(32,94,95)
NCCNOT(31,93,94)
NCCNOT(30,92,93)
NCCNOT(29,91,92)
NCCNOT(28,90,91)
NCCNOT(27,89,90)
NCCNOT(26,88,89)
NCCNOT(25,87,88)
NCCNOT(24,86,87)
NCCNOT(23,85,86)
NCCNOT(22,84,85)
NCCNOT(21,83,84)
NCCNOT(20,82,83)
NCCNOT(19,81,82)
NCCNOT(18,80,81)
NCCNOT(17,79,80)
NCCNOT(16,78,79)
NCCNOT(15,77,78)
NCCNOT(14,76,77)
NCCNOT(13,75,76)
NCCNOT(12,74,75)
NCCNOT(11,73,74)
NCCNOT(10,72,73)
NCCNOT(9,71,72)
NCCNOT(8,70,71)
NCCNOT(7,69,70)
NCCNOT(6,68,69)
NCCNOT(5,67,68)
NCCNOT(4,66,67)
NCCNOT(3,65,66)
NCCNOT(2,64,65)
NCNCNOT(0,1,64)

H(0)
H(1)
H(2)
H(3)
H(4)
H(5)
H(6)
H(7)
H(8)
H(9)
H(10)
H(11)
H(12)
H(13)
H(14)
H(15)
H(16)
H(17)
H(18)
H(19)
H(20)
H(21)
H(22)
H(23)
H(24)
H(25)
H(26)
H(27)
H(28)
H(29)
H(30)
H(31)
H(32)
H(33)
H(34)
H(35)
H(36)
H(37)
H(38)
H(39)
H(40)
H(41)
H(42)
H(43)
H(44)
H(45)
H(46)
H(47)
H(48)
H(49)
H(50)
H(51)
H(52)
H(53)
H(54)
H(55)
H(56)
H(57)
H(58)
H(59)
H(60)
H(61)
H(62)
H(63)

NCNCNOT(0,1,64)
NCCNOT(2,64,65)
NCCNOT(3,65,66)
NCCNOT(4,66,67)
NCCNOT(5,67,68)
NCCNOT(6,68,69)
NCCNOT(7,69,70)
NCCNOT(8,70,71)
NCCNOT(9,71,72)
NCCNOT(10,72,73)
NCCNOT(11,73,74)
NCCNOT(12,74,75)
NCCNOT(13,75,76)
NCCNOT(14,76,77)
NCCNOT(15,77,78)
NCCNOT(16,78,79)
NCCNOT(17,79,80)
NCCNOT(18,80,81)
NCCNOT(19,81,82)
NCCNOT(20,82,83)
NCCNOT(21,83,84)
NCCNOT(22,84,85)
NCCNOT(23,85,86)
NCCNOT(24,86,87)
NCCNOT(25,87,88)
NCCNOT(26,88,89)
NCCNOT(27,89,90)
NCCNOT(28,90,91)
NCCNOT(29,91,92)
NCCNOT(30,92,93)
NCCNOT(31,93,94)
NCCNOT(32,94,95)
NCCNOT(33,95,96)
NCCNOT(34,96,97)
NCCNOT(35,97,98)
NCCNOT(36,98,99)
NCCNOT(37,99,100)
NCCNOT(38,100,101)
NCCNOT(39,101,102)
NCCNOT(40,102,103)
NCCNOT(41,103,104)
NCCNOT(42,104,105)
NCCNOT(43,105,106)
NCCNOT(44,106,107)
NCCNOT(45,107,108)
NCCNOT(46,108,109)
NCCNOT(47,109,110)
NCCNOT(48,110,111)
NCCNOT(49,111,112)
NCCNOT(50,112,113)
NCCNOT(51,113,114)
NCCNOT(52,114,115)
NCCNOT(53,115,116)
NCCNOT(54,116,117)
NCCNOT(55,117,118)
NCCNOT(56,118,119)
NCCNOT(57,119,120)
NCCNOT(58,120,121)
NCCNOT(59,121,122)
NCCNOT(60,122,123)
NCCNOT(61,123,124)
NCCNOT(62,124,125)
NCCNOT(63,125,126)
CNOT(126,127)
// The key step!
Z(127)
CNOT(126,127)
NCCNOT(63,125,126)
NCCNOT(62,124,125)
NCCNOT(61,123,124)
NCCNOT(60,122,123)
NCCNOT(59,121,122)
NCCNOT(58,120,121)
NCCNOT(57,119,120)
NCCNOT(56,118,119)
NCCNOT(55,117,118)
NCCNOT(54,116,117)
NCCNOT(53,115,116)
NCCNOT(52,114,115)
NCCNOT(51,113,114)
NCCNOT(50,112,113)
NCCNOT(49,111,112)
NCCNOT(48,110,111)
NCCNOT(47,109,110)
NCCNOT(46,108,109)
NCCNOT(45,107,108)
NCCNOT(44,106,107)
NCCNOT(43,105,106)
NCCNOT(42,104,105)
NCCNOT(41,103,104)
NCCNOT(40,102,103)
NCCNOT(39,101,102)
NCCNOT(38,100,101)
NCCNOT(37,99,100)
NCCNOT(36,98,99)
NCCNOT(35,97,98)
NCCNOT(34,96,97)
NCCNOT(33,95,96)
NCCNOT(32,94,95)
NCCNOT(31,93,94)
NCCNOT(30,92,93)
NCCNOT(29,91,92)
NCCNOT(28,90,91)
NCCNOT(27,89,90)
NCCNOT(26,88,89)
NCCNOT(25,87,88)
NCCNOT(24,86,87)
NCCNOT(23,85,86)
NCCNOT(22,84,85)
NCCNOT(21,83,84)
NCCNOT(20,82,83)
NCCNOT(19,81,82)
NCCNOT(18,80,81)
NCCNOT(17,79,80)
NCCNOT(16,78,79)
NCCNOT(15,77,78)
NCCNOT(14,76,77)
NCCNOT(13,75,76)
NCCNOT(12,74,75)
NCCNOT(11,73,74)
NCCNOT(10,72,73)
NCCNOT(9,71,72)
NCCNOT(8,70,71)
NCCNOT(7,69,70)
NCCNOT(6,68,69)
NCCNOT(5,67,68)
NCCNOT(4,66,67)
NCCNOT(3,65,66)
NCCNOT(2,64,65)
NCNCNOT(0,1,64)

H(0)
H(1)
H(2)
H(3)
H(4)
H(5)
H(6)
H(7)
H(8)
H(9)
H(10)
H(11)
H(12)
H(13)
H(14)
H(15)
H(16)
H(17)
H(18)
H(19)
H(20)
H(21)
H(22)
H(23)
H(24)
H(25)
H(26)
H(27)
H(28)
H(29)
H(30)
H(31)
H(32)
H(33)
H(34)
H(35)
H(36)
H(37)
H(38)
H(39)
H(40)
H(41)
H(42)
H(43)
H(44)
H(45)
H(46)
H(47)
H(48)
H(49)
H(50)
H(51)
H(52)
H(53)
H(54)
H(55)
H(56)
H(57)
H(58)
H(59)
H(60)
H(61)
H(62)
H(63)

assert state in span {
  |00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000> ,
  |0000000000000000000000000000000000000000000000000000000000000000++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++>
}

measure 0..127
